<html>
<head>
</head>
<body onfocusout="parent.setEmailRange();" style="overflow-wrap: break-word;">
    ﻿



    <meta charset="utf-8">

    <title>Knowledge Base</title>



    <customheaders>

        <add name="X-Frame-Options" value="SAMEORIGIN">

        </add>
    </customheaders>


    <script type="text/javascript">
            function iframeDidLoad() {
            document.getElementById('VolvoSharepoint').removeAttribute("onload");
            let existingSite = document.getElementById('VolvoSharepoint').src;
            if (!existingSite.includes("volvo")) {
                parent.Xrm.WebApi.online.retrieveMultipleRecords("jarvis_configurationjarvis", "?$select=jarvis_knowledgebaseoverviewurl&$filter=statecode eq 0&$top=1").then(
                    function success(results) {
                        console.log(results);
                        if (results.entities.length === 1) {
                            var result = results.entities[0];
                            var jarvis_knowledgebaseoverviewurl = result["jarvis_knowledgebaseoverviewurl"]; // Text
                            if (jarvis_knowledgebaseoverviewurl !== null && jarvis_knowledgebaseoverviewurl !== undefined) {
                                document.getElementById('VolvoSharepoint').src = jarvis_knowledgebaseoverviewurl;
                            }
                        }
                    },
                    function (error) {
                        console.log(error.message);
                    });
            }
        }
    </script>



    <iframe id="VolvoSharepoint" src="" onload="iframeDidLoad();" frameborder="0" marginheight="0" marginwidth="0" width="100%" height="100%" scrolling="no">
    </iframe>

</body>
</html>